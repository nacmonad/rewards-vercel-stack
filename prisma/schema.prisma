// schema.prisma

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["jsonProtocol"]
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl         = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING") // used for migrations
}

// Define default user roles
enum DefaultUserRole {
  ADMIN
  SALES
  CUSTOMER
}

// Define the User Role entity
model UserRole {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  description String?
  User        User[]
}

// Define the User entity
model User {
  id       Int      @id @default(autoincrement())
  name     String
  email    String   @unique
  password String
  roleId   Int
  role     UserRole @relation(fields: [roleId], references: [id])
  points   Point[]
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

// Define the Point entity
model Point {
  id         Int       @id @default(autoincrement())
  code       String    @unique
  awardedAt  DateTime? @default(now())
  redeemedAt DateTime? @default(now())
  ownerId    Int?
  owner      User?     @relation(fields: [ownerId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}
